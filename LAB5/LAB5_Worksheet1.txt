-- 1)a (using where clause)

-- CUSTOMER_NUMBER, CUSTOMER_NAME (FIRST_NAME + LAST_NAME), ORDER_NUMBER, ORDER_DATE, SALESREP_NAME(FIRST_NAME + LAST_NAME), SALESREP_CITY

SELECT C.CUSTOMER_NUMBER,
    C.FIRST_NAME || ' ' || C.LAST_NAME AS CUSTOMER_NAME,
    O.ORDER_NUMBER, 
    O.ORDER_DATE, 
    S.FIRST_NAME || ' ' || S.LAST_NAME AS SALESREP_NAME, 
    S.CITY AS SALESREP_CITY
FROM CUSTOMERJ C, ORDERSJ O, SALESREPJ S
WHERE C.SALES_REP_NUMBER = S.SALES_REP_NUMBER AND C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER
ORDER BY O.ORDER_DATE;   

-- 1)b (using a INNER JOIN statement)

SELECT C.CUSTOMER_NUMBER,
    C.FIRST_NAME || ' ' || C.LAST_NAME AS CUSTOMER_NAME,
    O.ORDER_NUMBER, 
    O.ORDER_DATE, 
    S.FIRST_NAME || ' ' || S.LAST_NAME AS SALESREP_NAME, 
    S.CITY AS SALESREP_CITY
FROM CUSTOMERJ C INNER JOIN SALESREPJ S
ON C.SALES_REP_NUMBER = S.SALES_REP_NUMBER
INNER JOIN ORDERSJ O
ON C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER
ORDER BY O.ORDER_DATE;

-- 2)
-- CUSTOMER_NUMBER, CUSTOMER_NAME, PART_NUMBER, PART_DESCRIPTION, NUMBER_ORDERED, QUOTED_PRICE, EXTENDED_PRICE 

CREATE VIEW CustOrdView  AS(
    SELECT C.CUSTOMER_NUMBER,
           C.FIRST_NAME || ' ' || C.LAST_NAME AS CUSTOMER_NAME,
           P.PART_NUMBER,
           P.PART_DESCRIPTION,
           O.NUMBER_ORDERED,
           O.QUOTED_PRICE,
           ROUND(O.QUOTED_PRICE * O.NUMBER_ORDERED, 2) AS EXTENDED_PRICE
    FROM ORDERLINEJ O INNER JOIN PARTJ P
    ON O.PART_NUMBER = P.PART_NUMBER
    INNER JOIN ORDERSJ
    ON ORDERSJ.ORDER_NUMBER = O.ORDER_NUMBER
    INNER JOIN CUSTOMERJ C
    ON C.CUSTOMER_NUMBER = ORDERSJ.CUSTOMER_NUMBER);

UPDATE ORDERLINEJ
SET PART_NUMBER = 'CB03'
WHERE ORDER_NUMBER = 12494;

UPDATE ORDERLINEJ
SET PART_NUMBER = 'BT04'
WHERE ORDER_NUMBER = 12500;
    
SELECT * FROM CustOrdView;


-- 3) LEFT JOIN
-- CUSTOMER_NUMBER, CUSTOMER_NAME, ORDER_NUMBER, ORDER_DATE

SELECT C.CUSTOMER_NUMBER,
       C.FIRST_NAME || ' ' || C.LAST_NAME AS CUSTOMER_NAME,
       O.ORDER_NUMBER,
       O.ORDER_DATE
FROM CUSTOMERJ C LEFT JOIN ORDERSJ O
ON C.CUSTOMER_NUMBER = O.CUSTOMER_NUMBER
ORDER BY O.ORDER_NUMBER;

--4) RIGHT JOIN
-- CUSTOMER_NUMBER, CUSTOMER_NAME, SALESREP_NAME, SALESREP_CITY

SELECT C.CUSTOMER_NUMBER,
       C.FIRST_NAME || ' ' || C.LAST_NAME AS CUSTOMER_NAME,
       S.FIRST_NAME || ' ' || S.LAST_NAME AS SALESREP_NAME, 
       S.CITY AS SALESREP_CITY
FROM CUSTOMERJ C RIGHT JOIN SALESREPJ S
ON C.SALES_REP_NUMBER = S.SALES_REP_NUMBER
ORDER BY C.CUSTOMER_NUMBER;